(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,43692,e=>{"use strict";var r=e.i(65821),t=e.i(34826),a=e.i(51999);function s(){let[e,s]=(0,t.useState)([]),[i,l]=(0,t.useState)([]),[n,c]=(0,t.useState)(!1),[d,o]=(0,t.useState)(!0),[u,m]=(0,t.useState)(1),[x,p]=(0,t.useState)(""),[h,g]=(0,t.useState)("newest"),[f,b]=(0,t.useState)(!1),[v,j]=(0,t.useState)(null),y={name:"",description:"",price:"",stock:"",categoryId:"",images:[""],isVisible:!0},[N,w]=(0,t.useState)(y),k=async(e,r=!1)=>{if(!n){c(!0);try{let t="createdAt",i="desc";"price-low"===h?(t="price",i="asc"):"price-high"===h&&(t="price",i="desc");let l=(await a.adminProductAPI.list({page:e,limit:30,search:x,sortBy:t,order:i})).data.products;r?s(l):s(e=>{let r=new Set(e.map(e=>String(e.id))),t=l.filter(e=>!r.has(String(e.id)));return[...e,...t]}),o(30===l.length)}catch(e){console.error(e),alert("Failed to load products")}finally{c(!1)}}},S=async()=>{try{let e=await a.categoryAPI.list();l(e.data.categories||[])}catch(e){console.error(e)}};(0,t.useEffect)(()=>{m(1),o(!0),k(1,!0)},[x,h]),(0,t.useEffect)(()=>{S()},[]),(0,t.useEffect)(()=>{if(!d||n)return;let e=new IntersectionObserver(e=>{e[0].isIntersecting&&m(e=>{let r=e+1;return k(r,!1),r})},{threshold:1}),r=document.getElementById("sentinel");return r&&e.observe(r),()=>{r&&e.unobserve(r)}},[d,n]);let P=async()=>{try{let e={name:N.name,description:N.description,price:Number(N.price),stock:Number(N.stock),categoryId:Number(N.categoryId),images:N.images.filter(Boolean),isVisible:N.isVisible};v?await a.adminProductAPI.update(v.id,e):await a.adminProductAPI.create(e),b(!1),k(1,!0)}catch(e){console.error(e),alert("Save failed")}},C=async e=>{if(confirm("Delete this product permanently?"))try{await a.adminProductAPI.remove(e),k(1,!0)}catch(e){console.error(e),alert("Delete failed")}},I=async e=>{try{await a.adminProductAPI.update(e.id,{isVisible:!e.isVisible}),k(1,!0)}catch(e){console.error(e),alert("Update failed")}};return n?(0,r.jsx)("div",{className:"p-10",children:"Loading admin panel..."}):(0,r.jsx)(r.Fragment,{children:(0,r.jsxs)("div",{className:"min-h-screen bg-[var(--background)] pt-24 px-4 sm:px-6 lg:px-8 pb-12",children:[(0,r.jsxs)("div",{className:"flex flex-col sm:flex-row justify-between items-center mb-8 gap-4",children:[(0,r.jsx)("h1",{className:"text-3xl font-serif font-bold text-[var(--foreground)]",children:"Manage Products"}),(0,r.jsx)("button",{onClick:()=>{w(y),j(null),b(!0)},className:"btn-primary px-6 py-2.5 flex items-center gap-2 shadow-md hover:shadow-lg",children:"+ Add Product"})]}),(0,r.jsxs)("div",{className:"flex gap-4 mb-8",children:[(0,r.jsx)("input",{className:"border border-[var(--border)] px-4 py-2.5 w-64 rounded-full bg-[var(--surface)] text-[var(--foreground)] focus:outline-none focus:ring-2 focus:ring-[var(--primary-light)]",placeholder:"Search...",value:x,onChange:e=>p(e.target.value)}),(0,r.jsxs)("select",{className:"border border-[var(--border)] px-4 py-2.5 rounded-full bg-[var(--surface)] text-[var(--foreground)] focus:outline-none focus:ring-2 focus:ring-[var(--primary-light)]",value:h,onChange:e=>g(e.target.value),children:[(0,r.jsx)("option",{value:"newest",children:"Newest"}),(0,r.jsx)("option",{value:"price-low",children:"Price (Low → High)"}),(0,r.jsx)("option",{value:"price-high",children:"Price (High → Low)"})]})]}),(0,r.jsx)("div",{className:"overflow-x-auto rounded-2xl border border-[var(--border)] shadow-sm",children:(0,r.jsxs)("table",{className:"w-full text-sm text-left",children:[(0,r.jsx)("thead",{className:"bg-[var(--surface-alt)] text-[var(--foreground)] font-serif uppercase tracking-wider text-xs",children:(0,r.jsxs)("tr",{className:"[&>th]:p-4",children:[(0,r.jsx)("th",{children:"ID"}),(0,r.jsx)("th",{children:"Name"}),(0,r.jsx)("th",{children:"Category"}),(0,r.jsx)("th",{children:"Price"}),(0,r.jsx)("th",{children:"Stock"}),(0,r.jsx)("th",{children:"Status"}),(0,r.jsx)("th",{className:"w-[200px]",children:"Actions"})]})}),(0,r.jsxs)("tbody",{className:"bg-[var(--surface)] divide-y divide-[var(--border)]",children:[e.map(e=>(0,r.jsxs)("tr",{className:"hover:bg-[var(--surface-alt)] transition-colors [&>td]:p-4 text-[var(--foreground)]",children:[(0,r.jsx)("td",{className:"font-mono text-gray-500 dark:text-gray-400",children:e.id}),(0,r.jsx)("td",{className:"font-medium",children:e.name}),(0,r.jsx)("td",{children:e.category?.name||"-"}),(0,r.jsxs)("td",{className:"font-bold text-[var(--primary)]",children:["₹",e.price]}),(0,r.jsx)("td",{children:e.stock}),(0,r.jsx)("td",{children:e.isVisible?(0,r.jsx)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-400",children:"Visible"}):(0,r.jsx)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-red-100 text-red-800 dark:bg-red-900/30 dark:text-red-400",children:"Hidden"})}),(0,r.jsxs)("td",{className:"flex gap-2",children:[(0,r.jsx)("button",{className:"px-3 py-1.5 rounded-lg border border-[var(--border)] hover:bg-[var(--surface-alt)] hover:text-[var(--primary)] transition-colors",onClick:()=>{j(e),w({name:e.name,description:e.description,price:e.price,stock:e.stock,categoryId:e.categoryId,images:e.images.length?e.images:[""],isVisible:e.isVisible}),b(!0)},children:"Edit"}),(0,r.jsx)("button",{className:`px-3 py-1.5 rounded-lg border transition-colors ${e.isVisible?"text-red-600 border-red-200 hover:bg-red-50":"text-green-600 border-green-200 hover:bg-green-50"}`,onClick:()=>I(e),children:e.isVisible?"Hide":"Show"}),(0,r.jsx)("button",{className:"px-3 py-1.5 rounded-lg border border-red-200 text-red-600 hover:bg-red-50 transition-colors",onClick:()=>C(e.id),children:"Delete"})]})]},e.id)),(0,r.jsx)("tr",{id:"sentinel",children:(0,r.jsxs)("td",{colSpan:"7",className:"p-6 text-center text-gray-500",children:[n&&"Loading more products...",!d&&e.length>0&&"End of list"]})})]})]})}),f&&(0,r.jsx)("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center z-50 animate-fade-in",children:(0,r.jsxs)("div",{className:"bg-[var(--surface)] p-8 w-[480px] space-y-5 rounded-3xl shadow-2xl animate-scale-in",children:[(0,r.jsx)("h2",{className:"font-serif font-bold text-2xl text-[var(--foreground)]",children:v?"Edit Product":"Create Product"}),(0,r.jsx)("input",{className:"input-premium w-full",placeholder:"Name",value:N.name,onChange:e=>w({...N,name:e.target.value})}),(0,r.jsx)("textarea",{className:"input-premium w-full min-h-[100px]",placeholder:"Description",value:N.description,onChange:e=>w({...N,description:e.target.value})}),(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,r.jsx)("input",{className:"input-premium w-full",placeholder:"Price",type:"number",value:N.price,onChange:e=>w({...N,price:e.target.value})}),(0,r.jsx)("input",{className:"input-premium w-full",placeholder:"Stock",type:"number",value:N.stock,onChange:e=>w({...N,stock:e.target.value})})]}),(0,r.jsxs)("select",{className:"input-premium w-full",value:N.categoryId,onChange:e=>w({...N,categoryId:e.target.value}),children:[(0,r.jsx)("option",{value:"",children:"Select category"}),i.map(e=>(0,r.jsx)("option",{value:e.id,children:e.name},e.id))]}),(0,r.jsx)("div",{className:"space-y-2 max-h-40 overflow-y-auto pr-2",children:N.images.map((e,t)=>(0,r.jsx)("input",{className:"input-premium w-full text-sm",placeholder:`Image URL ${t+1}`,value:e,onChange:e=>{let r=[...N.images];r[t]=e.target.value,w({...N,images:r})}},t))}),(0,r.jsx)("button",{onClick:()=>w({...N,images:[...N.images,""]}),className:"text-sm text-[var(--primary)] hover:underline font-medium",children:"+ Add another image"}),(0,r.jsxs)("label",{className:"flex gap-3 items-center p-3 rounded-xl bg-[var(--surface-alt)] cursor-pointer",children:[(0,r.jsx)("input",{type:"checkbox",checked:N.isVisible,onChange:e=>w({...N,isVisible:e.target.checked}),className:"w-5 h-5 text-[var(--primary)] rounded focus:ring-[var(--primary)]"}),(0,r.jsx)("span",{className:"font-medium text-[var(--foreground)]",children:"Visible to customers"})]}),(0,r.jsxs)("div",{className:"flex justify-between pt-4 gap-4",children:[(0,r.jsx)("button",{onClick:()=>b(!1),className:"flex-1 py-3 rounded-xl border border-[var(--border)] hover:bg-[var(--surface-alt)] transition-colors font-medium",children:"Cancel"}),(0,r.jsx)("button",{onClick:P,className:"flex-1 btn-primary py-3",children:"Save Product"})]})]})})]})})}e.s(["default",()=>s])}]);